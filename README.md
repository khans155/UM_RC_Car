# Universal (AC Series) Motor Powered RC Car
<p align="center">
<img src="photos/build_progress/20230828_005356.jpg" width="250"><img src="photos/build_progress/20230828_005344.jpg" width="250"><img src="photos/build_progress/20230827_232723.jpg" width="250">
  </p>
  
## Motor Control System
The motor control system consists of two motor driver boards, a microcontroller, I FlySky receiver, the AC Series motor, and two servos for steering. One motor driver powers the stator windings, while the other powers the rotor windings. The microcontroller is connected to the receiver and motor drivers; it controls the speed, torque, and direction of the motor based on the input from the receiver. The motor unit is a AC Series motor, with stator and rotor windings. 

Initially, the motor driver used was a L298N unit. This was rated for 3A and wasn’t cable of powering the motor at high speed/torque. This was replaced with BTS7960 driver which is rated up to 43A. The figure below shows the pin layout for this driver. The power source for the drivers is the 25V Li-ion battery pack. Two of these motor drivers are used, one for controlling the power to the stator winding, and the other to control the power to the rotor windings. They also allow for the control of the direction of the motor, through pin 40 and 42. The rotational speed and direction of the motor is mainly controlled via the motor driver connected to the rotor windings. A PWM signal is generated by the microcontroller and is connected to pin 44. The driver connected to the stator windings is used to control the torque the motor supplies. At low speeds, the torque from the motor is increased by having this driver supply higher power to the stator windings, while at higher speeds, the power is reduced. 
<p align="center">
<img src="photos/components/motor_driver_old.jpg" width="250"><img src="photos/components/motor_driver_new.jpg" width="250"><img src="photos/components/motor_driver_connectors.jpg" width="250">
</p>

The first iteration used a Raspberry Pi 4 as the translating layer between the receiver and the motor drivers, however this was replaced with an ESP32 board because the extra functionality of the Pi wasn’t needed. The ESP32 was programmed to receive the iBUS signal from the FlySky receiver. The receiver is the 10 channel 2.5GHz FS-IA10B which contains 10 PWM outputs, as well as serial output using the iBUS protocol. For the microcontroller to communicate using this protocol, the IBusBM library is included in the script. The function IBus.begin(Serial2, 1) initiates serial communication on pin 1 of the ESP32, which is connected to the FlySky receivers IBUS line. The FlySky remote is configured to send the throttle PWM signal on channel 2 of the IBUS line. This is then read by the microcontroller, and converted to duty cycles for the stator and motor drivers. Channel 5 of the IBUS line is connected to a switch on the remote, which is used to control the direction of the motor. The ESP32 monitors channel 5 and will change the direction of the motor when the switch is flipped, using the motor driver connected to the rotor windings. 

The servo motors are directly connected to the FlySky receiver because they don’t require any translation layer. 

## Power System (Batteries, Voltage Regulator)
body --tbd--
## 3D Design (Chasiss, Axles, Wheels, Drive Gears/Belt)
body --tbd--
## Problems And Improvements
body --tbd--
