# Universal (AC Series) Motor Powered RC Car (Work in Progress)
<p align="center">
<img src="photos/build_progress/20230828_005356.jpg" width="250"><img src="photos/build_progress/20230828_005344.jpg" width="250"><img src="photos/build_progress/20230827_232723.jpg" width="250">
  </p>

What motivated me to attempt this project was learning how universal motors are wired. Their wiring allows them to operate on both AC and DC power sources due to the stator and rotor windings being connected in series, though due to this you can't control its direction. However, when these windings are supplied separately from a DC source, it becomes possible to control torque and speed independently. This capability is especially beneficial in situations where high torque is required, such as when a vehicle is stuck against an obstacle and needs additional torque to overcome it.
  
## Motor Control System
The motor control system consists of:
- Two high-current motor driver boards  
- An ESP32 microcontroller  
- A FlySky FS-IA10B receiver and FlySky Remote
- An AC series motor (separate stator and rotor windings)  
- Servo motors for steering  

One motor driver controls the stator windings, while the second driver controls the rotor windings. The ESP32 acts as the control interface between the FlySky receiver and the motor drivers, translating remote inputs into motor speed, torque, and direction commands.
<p align="center">
<img src="photos/components/motor.jpg" width="250">
<img src="photos/components/remote.jpg" width="250">
</p>

The initial design used an L298N motor driver, rated for 3 A. This driver was insufficient for delivering the current required for the speed/torque of the AC series motor for this project.

To address this, the L298N was replaced with the **BTS7960 motor driver**, which is rated for up to 43 A.

Two BTS7960 drivers are used for:
- **Driver 1:** Controls power delivered to the stator windings (torque control)
- **Driver 2:** Controls power and direction of the rotor windings (speed and direction control)

Both drivers are powered by a 25 V Li-ion battery pack.

---

### Rotor Windings (Speed & Direction)
- Primary control of motor speed and direction  
- Direction control via **control pins 40 and 42**
- Speed controlled using a **PWM signal on pin 44** generated by the ESP32

### Stator Windings (Torque Control)
- Used to control motor torque independently of speed
- At low speeds, higher power is supplied to increase torque
- At higher speeds, stator power is reduced to limit current draw

This approach enables independent control of **torque and rotational speed**.
<p align="center">
<img src="photos/components/motor_driver_old.jpg" width="250"><img src="photos/components/motor_driver_new.jpg" width="260"><img src="photos/components/motor_driver_connectors.jpg" width="250">
</p>

---

The initial system architecture used a Raspberry Pi 4 as an intermediary between the radio receiver and the motor drivers. This was later replaced with an ESP32, as the Raspberry Pi’s additional processing capability and operating system overhead were unnecessary for a real-time motor control application, and also because I fried the Raspberry Pi :). The ESP32 provides a simpler and more deterministic control platform while still offering sufficient performance for signal decoding and PWM generation.

The ESP32 is programmed to receive iBUS serial data from a FlySky FS-IA10B 10-channel 2.5 GHz receiver, which supports both individual PWM outputs and a serial iBUS interface. Communication over this protocol is handled using the IBusBM library. Serial communication is initialized using IBus.begin(Serial2, 1), where pin 1 of the ESP32 is connected to the receiver’s iBUS output.

The FlySky transmitter is configured to transmit the throttle signal on channel 2 of the iBUS stream. This signal is decoded by the ESP32 and converted into appropriate PWM duty cycles for the stator and motor drivers. Channel 5 is mapped to a switch on the transmitter and is used to control motor direction. The ESP32 continuously monitors this channel and reverses motor direction when the switch state changes by actuating the motor driver connected to the rotor windings.

Servo motors are connected directly to the FlySky receiver, as they accept standard PWM signals and therefore do not require any intermediate signal translation.


<p align="center">
<img src="photos/components/ESP32.jpg" width="300"><img src="photos/components/reciever.jpg" width="300">
</p>

## Power System (Batteries, Voltage Regulator)
<p align="center">
<img src="photos/components/batt.jpg" width="250">
<img src="photos/components/batt_pack.jpg" width="250">
</p>

<p align="center">
<img src="photos/build_progress/power_button.jpg" width="250">
<img src="photos/build_progress/junc_box.jpg" width="250">
</p>

## 3D Design and Fabrication
<p align="center">
<img src="photos/3D_models/chassis_lower.jpg" width="250">
<img src="photos/3D_models/chassis_upper.jpg" width="250">
<img src="photos/components/main_chas.jpg" width="330">
</p>

<p align="center">
<img src="photos/3D_models/front_suspension.jpg" width="700">
<img src="photos/components/front_assembly.jpg" width="350">
</p>

<p align="center">
<img src="photos/3D_models/motor_mount.jpg" width="200">
<img src="photos/3D_models/moter_to_axle.jpg" width="200">
<img src="photos/3D_models/motor_to_chassis.jpg" width="200">
<img src="photos/3D_models/motor_to_spring.jpg" width="200">
</p>

<p align="center">
<img src="photos/3D_models/rear_axle_inner.jpg" width="200">
<img src="photos/3D_models/rear_axle_outer.jpg" width="200">
<img src="photos/3D_models/rear_rim.jpg" width="200">
<img src="photos/3D_models/rear_tire.jpg" width="200">
<img src="photos/components/axel_w_tires.jpg" width="250">
<img src="photos/components/axel1.jpg" width="250">
<img src="photos/components/axel3.jpg" width="250">  
</p>

<p align="center">
<img src="photos/3D_models/motor_gear.jpg" width="200">
<img src="photos/3D_models/axle_gear.jpg" width="200">
</p>


## Progress Photos
<p align="center">
<img src="photos/build_progress/20230818_162955.jpg" width="500">
<img src="photos/build_progress/20230819_165815.jpg" width="500">
<img src="photos/build_progress/prog1.jpg" width="500">
<img src="photos/build_progress/prog2.jpg" width="500">
<img src="photos/build_progress/prog3.jpg" width="500">
<img src="photos/build_progress/20230827_164033.jpg" width="500">
<img src="photos/build_progress/20230827_211737.jpg" width="500">
</p>

